[tools]
gum = "latest"

[env]
PROJECT_ID = "sflab"
PROJECT_HOME = "{{ config_root }}"
PROJECT_SRC = "{{ config_root }}/src"
PROJECT_CONF = "{{ config_root }}/conf"
PROJECT_DOCS = "{{ config_root }}/docs"

_.file = [
  { path = "{{env.HOME}}/.env", optional = true },
  { path = ".env", optional = true },
  { path = ".creds.env.yaml", redact = true },
]
_.path = ["./scripts"]

[hooks]
enter = """
mise i -q

echo "-----------------------------------"
figlet "$PROJECT_ID"
echo "Welcome to the $PROJECT_ID DEV Workspace!"
echo "-----------------------------------"

# A problem is that this hook is executed on every `cd` into the sflab directory or its subdirectories (e.g. below ./src).
# To execute the hook only on first entry into the sflab root directory, the following logic can be used:
if [ -z "$MISE_ORIGINAL_CWD" ] || [[ "$MISE_ORIGINAL_CWD" != "$PWD"* ]]; then
  pre-commit install --hook-type pre-commit
fi

# Link vscode notes from home managed by dotfiles to project docs
mkdir -p $PROJECT_DOCS/notes/
ln -fs ~/notes/vscode $PROJECT_DOCS/notes
"""
